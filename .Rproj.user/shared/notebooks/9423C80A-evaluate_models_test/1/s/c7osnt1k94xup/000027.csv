"0","library(scales)"
"0","# Display coefficients against lambda."
"0","plot_coef_paths <- function(fit, alpha=1) {"
"0","  # Plot the paths of the continuous variables vs -log(lambda)"
"0","  lambdas <- fit$lambda"
"0","  coef_list <- list()"
"0","  for(i in 1:length(lambdas)) {"
"0","    lambda= lambdas[i]"
"0","    coef_list[[i]] <- coef(fit, lambda=lambda, alpha=alpha)"
"0","  }"
"0","  coefs.df <- data.frame(do.call(rbind, coef_list))"
"0","  coefs.df[""lambda""] <- lambdas # Append lambdas column for plotting"
"0","  coefs.df <- coefs.df %>% "
"0","    # Remove categorical preds"
"0","    select(-X.Intercept., "
"0","           -mmrc.X1, -mmrc.X2, -mmrc.X3, -mmrc.X4, "
"0","           -smoking_status.X1, -smoking_status.X2) "
"0","  "
"0","  # Parse the colnames with scales"
"0","  colnames(coefs.df) <- c("
"0","    ""Time"","
"0","    ""Age"","
"0","    ""Age^2"","
"0","    ""Height"","
"0","    ""Weight"","
"0","    ""BMI"","
"0","    ""FEV[1]"","
"0","    ""FVC"","
"0","    ""FIVC"","
"0","    ""FEV[1]/FVC"","
"0","    ""FEV[1]/FEV_6"","
"0","    ""PEF"","
"0","    ""MMEF"","
"0","    ""DLCO"","
"0","    ""SpO[2]"","
"0","    ""Hospitalisation~Past~Year"", # Tilde is parsed as space"
"0","    ""lambda"""
"0","  )"
"0","  coefs.df <- coefs.df %>%"
"0","    gather(""variable"", ""coef"", 1:(ncol(coefs.df)-1)) # Gather so we can group across variables, don't gather lambda."
"0","  "
"0","  available_linetypes <- c(""solid"", ""dashed"", ""dotted"", ""dotdash"", ""longdash"", ""twodash"")"
"0","  num_variables <- length(unique(coefs.df$variable))"
"0","  linetypes <- rep(available_linetypes, length.out = num_variables)"
"0","  "
"0","  # Plot the coefs, gathered and colored by variable."
"0","  plt <- ggplot(coefs.df) +"
"0","    geom_line(aes(x=-log(lambda), y=coef, group=variable, color=variable,"
"0","                  linetype=variable)) +"
"0","    scale_color_discrete(name=""Variable"","
"0","                         labels=label_parse()) + "
"0","    scale_linetype_manual(name=""Variable"","
"0","                          labels=label_parse(),"
"0","                          values=linetypes) + "
"0","    theme_bw() +"
"0","    labs(x=expression(-log(lambda)),"
"0","         y=""Coefficient"","
"0","         title=""Coefficient Paths (non-categorical)"")"
"0","  return(plt)"
"0","}"
"0","alpha=1"
"0","plt <- plot_coef_paths(fit.female, alpha=0.5)"
"0","print(plt)"
