"0","# Create dataframe of male-female coefs for each outcome, using the minimum value"
"0","create_coef_table <- function(dest_path) {"
"0","  outcomes <- c(""hosp_1_year"", "
"0","                ""hosp_3_year"","
"0","                ""hosp_5_year"","
"0","                ""mort_1_year"","
"0","                ""mort_3_year"","
"0","                ""mort_5_year"")"
"0","  "
"0","  female.coef_list <- list()"
"0","  male.coef_list <- list()"
"0","  for (outcome in outcomes) {"
"0","    # Load fit.female and fit.male"
"0","    load(paste(""models"", outcome, ""fit_female_adWcoef.Rda"", sep=""/""))"
"0","    load(paste(""models"", outcome, ""fit_male_adWcoef.Rda"", sep=""/""))"
"0","    female.coef_list["
"0","      paste(outcome, ""female"", sep=""."")] <-list(coef(fit.female))"
"0","    male.coef_list[paste(outcome, ""male"", sep=""."")] <- list(coef(fit.male))"
"0","  }"
"0","  coef.df <- cbind(data.frame(female.coef_list), data.frame(male.coef_list))"
"0","  save(coef.df, file=""results/coefs.Rda"")"
"0","  # coef.df <- data.frame(coef_list)"
"0","  coef.df <- coef.df %>% "
"0","    # Transpose"
"0","    t() %>% "
"0","    as.data.frame() %>%"
"0","    # group mmrc and smoking status"
"0","    group_mmrc() %>% "
"0","    group_smoking_status() %>% "
"0","    t() %>% "
"0","    as.data.frame() "
"0","  # Save coef.df for future use"
"0","  "
"0","  "
"0","  # Define rownames"
"0","  rownames(coef.df) <- c("
"0","    ""(Intercept)"","
"0","    ""Time"","
"0","    ""Age"","
"0","    ""Age^{2}"","
"0","    ""Height"","
"0","    ""Weight"","
"0","    ""BMI"","
"0","    ""FEV_{1}"","
"0","    ""FVC"","
"0","    ""FIVC"","
"0","    ""FEV_{1}/FVC"","
"0","    ""FEV_{1}/FEV_{6}"","
"0","    ""PEF"","
"0","    ""MMEF"","
"0","    ""DLCO"","
"0","    ""SpO^{2}"","
"0","    ""Hospitalisation (Past Year)"","
"0","    ""mMRC=1"","
"0","    ""mMRC=2"","
"0","    ""mMRC=3"","
"0","    ""mMRC=4"","
"0","    ""Smoking Status=Ex"","
"0","    ""Smoking Status=Current"""
"0","  )"
"0","  # Make rownames a column"
"0","  coef.df <- coef.df %>% "
"0","    rownames_to_column(""Variable"")"
"0","  # Prepare flextable"
"0","  options(digits=2)"
"0","  ft <- flextable(coef.df)"
"0","  # Apply sub and super scripting to the rownames."
"0","  # This approach is a hack, but it works"
"0","  for (i in 1:nrow(coef.df)) {"
"0","    ft <- ft %>%"
"0","      compose(i = i, j = ""Variable"","
"0","              value = format_sub_super_script(coef.df[i,""Variable""])"
"0","              )"
"0","  }"
"0","  ft <- ft %>% set_header_labels("
"0","    hosp_1_year.female=""Hosp. 1 years"", "
"0","    hosp_3_year.female=""Hosp. 3 years"","
"0","    hosp_5_year.female=""Hosp. 5 years"","
"0","    mort_1_year.female=""Mort. 1 years"","
"0","    mort_3_year.female=""Mort. 3 years"","
"0","    mort_5_year.female=""Mort. 5 years"","
"0","    hosp_1_year.male=""Hosp. 1 years"", "
"0","    hosp_3_year.male=""Hosp. 3 years"","
"0","    hosp_5_year.male=""Hosp. 5 years"","
"0","    mort_1_year.male=""Mort. 1 years"","
"0","    mort_3_year.male=""Mort. 3 years"","
"0","    mort_5_year.male=""Mort. 5 years"""
"0","    ) %>%"
"0","    add_header_row(values=c("""", ""Female"", ""Male""),"
"0","                   colwidths=c(1,6,6)) %>%"
"0","    merge_v(part=""header"") %>%"
"0","    set_table_properties(width=0.5) %>%"
"0","    align(align = ""center"", part=""all"") %>%"
"0","    autofit()"
"0","  ft  "
"0","  save_as_docx(ft, path=dest_path)  "
"0","  return(ft)"
"0","  options(digits=7)"
"0","}"
"0",""
"0","ft <- create_coef_table(""results/coefs.docx"")"
"0","ft"
