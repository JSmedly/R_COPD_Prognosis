"0","# Converts a list of 'y's and 'predictions' into a list of roc objects"
"0","create_roc_list <- function(y, preds) {"
"0","  roc <- lapply(1:nimp, function(i) roc(as.numeric(y[[i]]), "
"0","                                        as.numeric(preds[[i]]),"
"0","                                        direction=""<"","
"0","                                        levels=c(0,1)))"
"0","  return(roc)"
"0","}"
"0",""
"0","# Creates a dataframe with nimp rows of auc mean and standard errors"
"0","calculate_auc_df <- function(roc_list) {"
"0","  auc_df <- bind_rows(lapply(seq_along(roc_list), function(i) {"
"0","    auc_df <- data.frame("
"0","      auc_mean = ci(roc_list[[i]])[2],"
"0","      auc_se = (ci(roc_list[[i]])[3]-ci(roc_list[[i]])[1])/(2*1.96)"
"0","    )"
"0","    return(auc_df)"
"0","  }))"
"0","  return(auc_df)"
"0","}"
"0",""
"0","# Creates a dataframe with nimp rows of sens and spec mean and standard errors"
"0","roc_list <- roc_list.female"
"0","calculate_sens_spec_df <- function(roc_list) {"
"0","  sens_spec_df <- bind_rows(lapply(seq_along(roc_list), function(i) {"
"0","    coord <- coords(roc_list[[i]], ""best"", "
"0","                   ret=c(""sensitivity"", ""specificity""), "
"0","                   best.method=""closest.topleft"")"
"0","    sens <- ci.se(roc_list[[i]], specificities=coord$specificity,"
"0","                  boot.n=1000, progress=""none"")"
"0","    spec <- ci.sp(roc_list[[i]], sensitivities=coord$sensitivity,"
"0","                  boot.n=1000, progress=""none"")"
"0","    sens_spec_df <- data.frame("
"0","      sens_mean = sens[2],"
"0","      sens_se = (sens[3]-sens[1])/(2*1.96),"
"0","      spec_mean = spec[2],"
"0","      spec_se = (spec[3]-spec[1])/(2*1.96)"
"0","    )"
"0","    return(sens_spec_df)"
"0","  }))"
"0","}"
